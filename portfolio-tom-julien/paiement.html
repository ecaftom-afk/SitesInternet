<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confirmation de Livraison - Web Locations</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        .payment-card {
            background: white;
            padding: 2.5rem;
            border-radius: 24px;
            box-shadow: var(--shadow-lg);
            margin-bottom: 2rem;
        }

        .payment-summary {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);
            padding: 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
        }

        .stripe-button {
            display: block;
            width: 100%;
            padding: 1.5rem;
            background: var(--gradient);
            color: white;
            text-align: center;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.2rem;
            box-shadow: 0 8px 24px rgba(99, 102, 241, 0.3);
            transition: all 0.3s;
            border: none;
            cursor: pointer;
        }

        .stripe-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(99, 102, 241, 0.4);
        }

        .secure-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1rem;
            color: var(--gray);
            font-size: 0.9rem;
        }

        .price-breakdown {
            border-top: 2px solid rgba(99, 102, 241, 0.1);
            padding-top: 1.5rem;
            margin-top: 1.5rem;
        }

        .price-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-size: 1rem;
        }

        .price-row.total {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--primary);
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px solid var(--primary);
        }

        .info-box {
            background: rgba(99, 102, 241, 0.05);
            border-left: 4px solid var(--primary);
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .info-box h3 {
            margin-top: 0;
            color: var(--primary);
            font-size: 1.1rem;
        }

        /* RESPONSIVE - PAIEMENT PAGE */
        @media (max-width: 968px) {
            .container {
                max-width: 100% !important;
                padding: 0 1.5rem !important;
            }

            .payment-card {
                padding: 2rem;
            }

            .payment-summary {
                padding: 1.5rem;
            }
        }

        @media (max-width: 600px) {
            .container {
                padding: 0 1rem !important;
            }

            section {
                padding: 40px 0 !important;
            }

            h1 {
                font-size: 2rem !important;
            }

            p {
                font-size: 1rem !important;
            }

            .payment-card {
                padding: 1.5rem;
                border-radius: 20px;
            }

            .payment-card h2 {
                font-size: 1.4rem !important;
            }

            .payment-summary {
                padding: 1.2rem;
            }

            .stripe-button {
                padding: 1.2rem;
                font-size: 1rem;
            }

            .price-row {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
            }

            .price-row.total {
                font-size: 1.3rem;
            }

            .info-box {
                padding: 1.2rem;
            }

            .info-box h3 {
                font-size: 1rem;
            }

            .secure-badge {
                font-size: 0.85rem;
            }

            #satisfaction-section,
            #confirmation-message {
                padding: 1.5rem !important;
            }

            #satisfaction-section h2,
            #confirmation-message h3 {
                font-size: 1.3rem !important;
            }

            #config-details {
                font-size: 0.95rem !important;
            }
        }

        @media (max-width: 375px) {
            .payment-card {
                padding: 1.2rem;
            }

            h1 {
                font-size: 1.8rem !important;
            }

            .payment-card h2 {
                font-size: 1.2rem !important;
            }

            .stripe-button {
                padding: 1rem;
                font-size: 0.95rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <a href="index.html" class="logo" style="display: flex; align-items: center;">
                <img src="images/logowebduo.png" alt="WebDuo" style="height: 100px;">
            </a>
            <ul class="nav-links">
                <li><a href="index.html">Accueil</a></li>
                <li><a href="portfolio.html">Portfolio</a></li>
                <li><a href="tarifs.html">Tarifs</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </nav>
    </header>

    <div style="padding-top: 120px; min-height: 100vh; background: linear-gradient(135deg, rgba(99, 102, 241, 0.03) 0%, rgba(236, 72, 153, 0.03) 100%);">
        <section style="padding: 60px 0;">
            <div class="container" style="max-width: 800px; margin: 0 auto; padding: 0 2rem;">
                <div style="text-align: center; margin-bottom: 3rem;">
                    <div style="display: inline-block; background: var(--gradient); padding: 0.5rem 1.2rem; border-radius: 50px; color: white; font-weight: 700; font-size: 0.9rem; margin-bottom: 1rem;">
                        CONFIRMATION DE LIVRAISON
                    </div>
                    <h1 style="font-size: 3rem; font-weight: 900; margin-bottom: 1rem; color: var(--dark);">
                        Votre site est <span style="background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">termin√© !</span>
                    </h1>
                    <p style="font-size: 1.2rem; color: var(--gray);">
                        Testez votre site et confirmez votre satisfaction
                    </p>
                </div>

                <div class="payment-card">
                    <!-- √âtape 1: Pr√©visualisation -->
                    <div style="background: rgba(99, 102, 241, 0.05); padding: 2rem; border-radius: 16px; margin-bottom: 2rem; border: 2px solid rgba(99, 102, 241, 0.2);">
                        <h2 style="font-size: 1.8rem; font-weight: 900; margin-bottom: 1rem; color: var(--dark);">
                            üéâ √âtape 1 : Pr√©visualisez votre site
                        </h2>
                        <p style="color: var(--gray); line-height: 1.8; margin-bottom: 1.5rem;">
                            Votre site est pr√™t ! Cliquez sur le bouton ci-dessous pour le d√©couvrir en avant-premi√®re.
                        </p>
                        <a href="#" id="preview-link" class="stripe-button" style="background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); text-decoration: none; display: block;">
                            üëÄ Voir la pr√©visualisation de mon site
                        </a>
                        <p style="margin-top: 1rem; font-size: 0.9rem; color: var(--gray); text-align: center;">
                            Prenez tout le temps n√©cessaire pour tester votre site
                        </p>
                    </div>

                    <h2 style="font-size: 1.8rem; font-weight: 900; margin-bottom: 1.5rem; color: var(--dark);">
                        üìã R√©capitulatif de votre projet
                    </h2>

                    <div class="payment-summary" id="payment-summary">
                        <div style="font-weight: 700; font-size: 1.2rem; margin-bottom: 1rem; color: var(--dark);">
                            Votre configuration :
                        </div>
                        <div id="config-details" style="font-size: 1rem; line-height: 2; color: var(--gray);">
                            <!-- Rempli par JavaScript -->
                        </div>
                    </div>

                    <div class="price-breakdown">
                        <div class="price-row total">
                            <span>Montant total :</span>
                            <span id="total-price">-</span>
                        </div>
                    </div>

                    <!-- √âtape 2: Satisfaction -->
                    <div id="satisfaction-section" style="margin-top: 3rem; padding: 2rem; background: rgba(236, 72, 153, 0.05); border-radius: 16px; border: 2px solid rgba(236, 72, 153, 0.2);">
                        <h2 style="font-size: 1.8rem; font-weight: 900; margin-bottom: 1rem; color: var(--dark);">
                            ü§ù √âtape 2 : √ätes-vous satisfait ?
                        </h2>
                        <p style="color: var(--gray); line-height: 1.8; margin-bottom: 2rem;">
                            Apr√®s avoir test√© votre site, faites-nous savoir si tout correspond √† vos attentes.
                        </p>

                        <div style="display: grid; gap: 1rem;">
                            <button id="btn-satisfied" class="stripe-button" style="background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);">
                                ‚úÖ Oui, je suis satisfait ! Envoyez-moi le lien de paiement
                            </button>
                            <button id="btn-modifications" class="stripe-button" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                                üîß Je souhaite quelques modifications
                            </button>
                            <button id="btn-not-satisfied" class="stripe-button" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                                ‚ùå Je ne suis pas satisfait
                            </button>
                        </div>
                    </div>

                    <!-- Message de confirmation (masqu√© par d√©faut) -->
                    <div id="confirmation-message" style="display: none; margin-top: 2rem; padding: 2rem; background: rgba(34, 197, 94, 0.1); border-radius: 16px; border: 2px solid #22c55e;">
                        <h3 style="color: #22c55e; font-size: 1.5rem; font-weight: 900; margin-bottom: 1rem;">
                            üéâ Parfait ! Merci pour votre confiance
                        </h3>
                        <p style="color: var(--dark); line-height: 1.8; margin-bottom: 1rem;">
                            Nous vous envoyons imm√©diatement le lien de paiement s√©curis√© par email √† :
                        </p>
                        <p id="user-email" style="font-weight: 700; font-size: 1.2rem; color: var(--primary); margin-bottom: 1.5rem;">
                            <!-- Email rempli par JavaScript -->
                        </p>
                        <p style="color: var(--gray); font-size: 0.95rem; line-height: 1.8;">
                            D√®s r√©ception de votre paiement, nous publierons votre site en ligne dans les <strong>2 heures</strong> ! üöÄ
                        </p>
                    </div>

                    <!-- Info box -->
                    <div class="info-box" style="background: rgba(99, 102, 241, 0.05); border-left-color: var(--primary); margin-top: 2rem;">
                        <h3 style="color: var(--primary);">üí° Notre processus "Satisfaction garantie"</h3>
                        <ol style="margin: 0; padding-left: 1.5rem; line-height: 1.8;">
                            <li>Nous d√©veloppons votre site <strong>sans acompte</strong></li>
                            <li>Vous recevez un lien de pr√©visualisation</li>
                            <li>Vous testez et validez (ou demandez des modifications gratuites)</li>
                            <li>Une fois satisfait, nous vous envoyons un lien de paiement par email</li>
                            <li>Apr√®s paiement, publication imm√©diate de votre site !</li>
                        </ol>
                    </div>

                    <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(236, 72, 153, 0.05); border-radius: 12px; text-align: center;">
                        <p style="margin: 0; color: var(--gray); font-size: 0.95rem;">
                            Besoin d'aide ? Contactez-nous :
                            <a href="mailto:contact.website@gmail.com" style="color: var(--primary); font-weight: 600;">contact.website@gmail.com</a>
                            ou <a href="tel:+33643697006" style="color: var(--primary); font-weight: 600;">+33 6 43 69 70 06</a>
                        </p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <footer style="background: var(--dark); color: white; padding: 4rem 2rem 2rem; text-align: center;">
        <div style="max-width: 1200px; margin: 0 auto;">
            <p style="color: rgba(255,255,255,0.7); margin-bottom: 2rem; font-size: 1.05rem;">
                √âtudiants Ing√©nieurs Informatique ‚Ä¢ Passionn√©s de Code ‚Ä¢ Sites Sur Mesure ‚Ä¢ √Ä partir de 250‚Ç¨
            </p>
            <div style="display: flex; gap: 2rem; justify-content: center; margin-bottom: 2rem; flex-wrap: wrap;">
                <a href="index.html" style="color: rgba(255,255,255,0.8); text-decoration: none; transition: all 0.3s; font-weight: 600;">Accueil</a>
                <a href="portfolio.html" style="color: rgba(255,255,255,0.8); text-decoration: none; transition: all 0.3s; font-weight: 600;">Portfolio</a>
                <a href="tarifs.html" style="color: rgba(255,255,255,0.8); text-decoration: none; transition: all 0.3s; font-weight: 600;">Tarifs</a>
                <a href="contact.html" style="color: rgba(255,255,255,0.8); text-decoration: none; transition: all 0.3s; font-weight: 600;">Contact</a>
            </div>
            <p style="margin-top: 2rem; opacity: 0.5; font-size: 0.9rem;">
                ¬© 2025 Web Locations. Tous droits r√©serv√©s.
            </p>
        </div>
    </footer>

    <script>
        // Configuration - Email de contact pour recevoir les notifications
        const CONTACT_EMAIL = 'contact.website@gmail.com';

        // R√©cup√©rer les donn√©es du devis depuis localStorage
        function loadQuoteData() {
            const selection = localStorage.getItem('tarifsSelection');

            if (!selection) {
                // Rediriger vers la page tarifs si pas de donn√©es
                window.location.href = 'tarifs.html';
                return null;
            }

            return JSON.parse(selection);
        }

        // Afficher le r√©capitulatif
        function displaySummary() {
            const data = loadQuoteData();
            if (!data) return;

            const configDetails = document.getElementById('config-details');
            const totalPrice = document.getElementById('total-price');

            // Afficher la configuration
            let configHTML = '';
            // Gestion du nouveau format avec "pack"
            if (data.pack) {
                configHTML += `<div>‚úì ${data.pack.label}</div>`;
            }
            // R√©trocompatibilit√© avec l'ancien format "pages"
            else if (data.pages) {
                configHTML += `<div>‚úì ${data.pages.label} - ${data.pages.example}</div>`;
            }
            if (data.support) {
                const supportPrice = data.support.value === 0 ? '(inclus)' : `(+${data.support.value}‚Ç¨)`;
                configHTML += `<div>‚úì Support ${data.support.label} ${supportPrice}</div>`;
            }
            configDetails.innerHTML = configHTML;

            // Afficher le prix total
            const total = data.totalPrice || 250;
            totalPrice.textContent = `${total}‚Ç¨`;

            return data;
        }

        // G√©rer les boutons de satisfaction
        function setupSatisfactionButtons() {
            const btnSatisfied = document.getElementById('btn-satisfied');
            const btnModifications = document.getElementById('btn-modifications');
            const btnNotSatisfied = document.getElementById('btn-not-satisfied');
            const satisfactionSection = document.getElementById('satisfaction-section');
            const confirmationMessage = document.getElementById('confirmation-message');
            const userEmailElement = document.getElementById('user-email');

            // Bouton "Je suis satisfait"
            btnSatisfied.addEventListener('click', function() {
                const data = loadQuoteData();

                // R√©cup√©rer l'email du client (stock√© lors du formulaire de contact)
                const clientEmail = localStorage.getItem('clientEmail') || 'votre-email@example.com';
                userEmailElement.textContent = clientEmail;

                // Afficher le message de confirmation
                satisfactionSection.style.display = 'none';
                confirmationMessage.style.display = 'block';

                // Envoyer une notification (simulation - en production, utiliser un backend)
                sendSatisfactionNotification('satisfied', data, clientEmail);

                // Scroll vers le message
                confirmationMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
            });

            // Bouton "Je souhaite des modifications"
            btnModifications.addEventListener('click', function() {
                const data = loadQuoteData();
                const clientEmail = localStorage.getItem('clientEmail') || 'client';

                // Rediriger vers le formulaire de contact avec un message pr√©rempli
                const message = encodeURIComponent(
                    `Bonjour,\n\nJ'ai test√© la pr√©visualisation de mon site (Devis #${data.totalPrice}‚Ç¨) et je souhaiterais quelques modifications :\n\n[D√©crivez vos modifications ici]\n\nMerci !`
                );

                window.location.href = `contact.html?subject=Modifications&message=${message}`;
            });

            // Bouton "Je ne suis pas satisfait"
            btnNotSatisfied.addEventListener('click', function() {
                const data = loadQuoteData();

                if (confirm('Nous sommes d√©sol√©s que le site ne vous convienne pas.\n\nSouhaitez-vous nous expliquer ce qui ne va pas ? Nous ferons tout notre possible pour arranger les choses.')) {
                    const message = encodeURIComponent(
                        `Bonjour,\n\nMalheureusement, le site ne correspond pas √† mes attentes.\n\nVoici ce qui ne me convient pas :\n\n[Expliquez ici]\n\nDevis : ${data.totalPrice}‚Ç¨\n\nMerci`
                    );

                    window.location.href = `contact.html?subject=Non satisfait&message=${message}`;
                } else {
                    alert('Nous comprenons. N\'h√©sitez pas √† nous contacter si vous changez d\'avis.');
                }
            });
        }

        // Simuler l'envoi d'une notification (en production, utiliser un backend/API)
        function sendSatisfactionNotification(status, data, clientEmail) {
            console.log('üìß Notification envoy√©e:');
            console.log('Status:', status);
            console.log('Client:', clientEmail);
            console.log('Prix:', data.totalPrice);
            console.log('Pack:', data.pack ? data.pack.label : 'N/A');

            // En production, vous enverriez un email via un service comme EmailJS,
            // SendGrid, ou votre propre backend
            // Exemple avec EmailJS:
            /*
            emailjs.send("service_id", "template_id", {
                status: status,
                client_email: clientEmail,
                total_price: data.totalPrice,
                pack: data.pack ? data.pack.label : 'N/A',
                to_email: CONTACT_EMAIL
            });
            */
        }

        // Configurer le lien de pr√©visualisation
        function setupPreviewLink() {
            const previewLink = document.getElementById('preview-link');

            // En production, ce lien pointerait vers la pr√©visualisation du site du client
            // Pour l'instant, on peut le configurer manuellement
            previewLink.addEventListener('click', function(e) {
                e.preventDefault();

                // Vous pouvez personnaliser ce lien pour chaque client
                const previewUrl = localStorage.getItem('previewUrl') || '#';

                if (previewUrl === '#') {
                    alert('Le lien de pr√©visualisation sera fourni par WebDuo.\n\nVous recevrez un email avec le lien vers votre site une fois termin√©.');
                } else {
                    window.open(previewUrl, '_blank');
                }
            });
        }

        // Initialisation au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            displaySummary();
            setupSatisfactionButtons();
            setupPreviewLink();
        });
    </script>
</body>
</html>
